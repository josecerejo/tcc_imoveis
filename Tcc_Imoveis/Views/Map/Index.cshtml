@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@using Tcc_Imoveis.Models;
@using System.Data.Objects;
@section Head {
<script type="text/javascript">

    Array.max = function (array) {
        return Math.max.apply(Math, array);
    };
    Array.min = function (array) {
        return Math.min.apply(Math, array);
    };

    var map;
    var creator = "";
    var markersArray = new Array();
    var polyX = new Array();
    var polyY = new Array();
    var pontos = Array();
    var distanceWidget;
    var geocodeTimer;
    pontos['x'] = Array(@ViewBag.x);
    pontos['y'] = Array(@ViewBag.y);

 

</script>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script> 
    <script src="@Url.Content("~/Scripts/LibMaps/polygon.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/LibMaps/distancewidget.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/Maps/marker.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/Maps/acoes.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/Maps/widgets_mapa.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/Maps/eventos.js")" type="text/javascript"></script>
    <script>
        $(document).ready(function () {
            $("#btn_buscar").click(function () {
                $.post("/Map/PesquisaTempoReal", $("#formulario_busca_geral").serialize(), 
                function(json){
				    
				    reset();
		            $.each(json, function(i, imovel){
                        //verifica se o ponto não está vazio
                        if(imovel['x'] != undefined) 
                        {
                            cria_imovel(imovel);
                        }
		        
		            });
                });

            });
        });
        
    </script>
}
<style>
#map_canvas 
{
    width:100%;
    height:400px;
}
.btn_mapa 
{
    font-weight:bold;
		width: 150px;

}
#salvar_busca {display:none;}

</style>


<div id="column_left">
    <input type="hidden" id="distance" value="0.25" />
    <div id="map_canvas"></div> 
    <div id="salvar_busca">
        <div><b>Nome da pesquisa</b></div>
        <input type="text" id="nome_pesquisa"  />
        <input type="button" id="ok_salvar_pesquisa" value="Ok" onclick="salva_pesquisa();" />
    </div>
    <input type="button" value="exibir" onclick="exibir_pontos();" />

    <form id="formulario_busca_geral" method="post">
<table class="tb_att">
    <thead>
        <tr>
            <th class="th_attr">Atributo</th>
            <th class="th_attr">Condição</th>
            <th class="th_attr">Valor</th>
        </tr>
    </thead>
    <tbody>
    @foreach (AtributosGerais_Result atributos in ViewBag.atributos)
    {
        <tr>
   
        <td>@atributos.Descricao</td>
        <td>
        <select id="@("condicao_" + atributos.IdImovelAtributoTipo)" name="@("condicao_" + atributos.IdImovelAtributoTipo)">
            @foreach (Condicoes_Result condicao in ViewBag.condicoes)
            {
                <option value="@condicao.IdCondicao">@condicao.Descricao</option>
            }
        </select>
        </td>
        <td>
        @if (atributos.IdTipoDado == "NU")
        {
            <input type="text" name="@atributos.IdImovelAtributoTipo" id="@atributos.IdImovelAtributoTipo" />
        }
        else if (atributos.IdTipoDado == "BO")
        {
            <select id="@atributos.IdImovelAtributoTipo" name="@atributos.IdImovelAtributoTipo">
                <option value="SIM">SIM</option>
                <option value="NÂO">NÂO</option>
            </select>
        }
        </td>
    
        </tr>
                
    }
    </tbody>
</table>
</form>
<input type="button" value="buscar" id="btn_buscar" />
   
    <div id="area-site">
		<h1 class="titulo">Encontre seu imóvel</h1>
		<div class="topo-lista">
		Foram encontrados <strong>45</strong> imóveis
		<a href="#" class="bt2" onclick="alert('salvar lista');">Salvar lista</a>
		</div>
        <div id="listagem_imoveis"></div>
    </div>
</div>
      


       


      


